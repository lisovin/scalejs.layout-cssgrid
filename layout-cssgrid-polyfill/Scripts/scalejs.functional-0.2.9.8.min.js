define("scalejs.functional/functional",[],function(){function n(){var e=Array.prototype.slice.call(arguments,0).reverse();return function(){var t=e.reduce(function(e,t){return[t.apply(undefined,e)]},Array.prototype.slice.call(arguments));return t[0]}}function r(){var e=Array.prototype.slice.call(arguments,0);return function(){var t=e.reduce(function(e,t){return[t.apply(undefined,e)]},Array.prototype.slice.call(arguments,0));return t[0]}}function i(e,t){var n=Array.prototype.slice.call(arguments,2);return function(){return t.apply(e,n.concat(Array.prototype.slice.call(arguments,0)))}}function s(e,t){return function(){return e.apply(undefined,Array.prototype.slice.call(arguments,0,t))}}function o(){var t=Array.prototype.slice.call(arguments,0),n=t.reduce(function(t,n,r){return n===e?t.concat([r]):t},[]);return n.length===0?t[0].apply(undefined,t.slice(1)):function(){var e;for(e=0;e<Math.min(n.length,arguments.length);e+=1)t[n[e]]=arguments[e];return o.apply(undefined,t)}}var e={},t;return t=function(e,n){if(arguments.length===1)return t(e,e.length);var r=Array.prototype.slice.call(arguments,2);return r.length>=n?e.apply(this,r):function(){var i=r.concat(Array.prototype.slice.call(arguments,0));return i.unshift(e,n),t.apply(this,i)}},{_:e,compose:n,sequence:r,bind:i,aritize:s,curry:t,partial:o}}),define("scalejs.functional/builder",[],function(){function e(e){var t,n,r,i;return r=function(e){if(!e||e.kind!=="$")return e;if(typeof e.expr=="function")return e.expr.call(this);if(typeof e.expr=="string")return this[e.expr];throw new Error("Parameter in $(...) must be either a function or a string referencing a binding.")},i=function(e,i,s){function o(e){return e==="$return"||e==="$RETURN"||e==="$yield"||e==="$YIELD"}if(typeof n[e]!="function"&&e!=="$then"&&e!=="$else")throw new Error("This control construct may only be used if the computation expression builder defines a `"+e+"` method.");var u=r(i),a;if(s.length>0&&typeof n.combine!="function")throw new Error("This control construct may only be used if the computation expression builder defines a `combine` method.");if(o(e)){if(s.length===0)return n[e](u);if(typeof n.delay!="function")throw new Error("This control construct may only be used if the computation expression builder defines a `delay` method.");return n.combine(n[e](u),n.delay(function(){return t(s)}))}if(e==="$for")return n.combine(n.$for(i.items,function(e){var n=Array.prototype.slice.call(i.cexpr);return this[i.name]=e,t(n)}),t(s));if(e==="$while"){if(typeof n.delay!="function")throw new Error("This control construct may only be used if the computation expression builder defines a `delay` method.");return u=n.$while(i.condition.bind(this),n.delay(function(){var e=Array.prototype.slice.call(i.cexpr);return t(e)})),s.length>0?n.combine(u,t(s)):u}return e==="$then"||e==="$else"?(a=Array.prototype.slice.call(i.cexpr),n.combine(t(a),s)):n.combine(n[e](u),t(s))},e.missing||(e.missing=function(e){throw e.kind?new Error('Unknown operation "'+e.kind+'". '+"Either define `missing` method on the builder or fix the spelling of the operation."):new Error("Expression "+JSON.stringify(e)+" cannot be processed. "+"Either define `missing` method on the builder or convert expression to a function.")}),t=function(e){var s;e=Array.prototype.slice.call(e);if(e.length===0){if(n.zero)return n.zero();throw new Error("Computation expression builder must define `zero` method.")}s=e.shift();if(s.kind==="let")return this[s.name]=r(s.expr),t.call(this,e);if(s.kind==="do")return s.expr.call(this),t.call(this,e);if(s.kind==="letBind")return n.bind(s.expr.bind(this),function(n){return this[s.name]=n,t.call(this,e)}.bind(this));if(s.kind==="doBind"||s.kind==="$"){if(e.length>0)return n.bind(s.expr.bind(this),function(){return t.call(this,e)}.bind(this));if(typeof n.$return!="function")throw new Error("This control construct may only be used if the computation expression builder defines a `$return` method.");return n.bind(s.expr.bind(this),function(e){return n.$return(e)})}return s.kind==="$return"||s.kind==="$RETURN"||s.kind==="$yield"||s.kind==="$YIELD"?i(s.kind,s.expr,e):s.kind==="$for"||s.kind==="$while"?i(s.kind,s,e):s.kind==="$if"?s.condition.call(this)?i("$then",s.thenExpr,e):s.elseExpr?i("$else",s.elseExpr,e):i(t([]),e):typeof s=="function"&&n.call?(n.call(this),t.call(this,e)):typeof s=="function"?(s.call(this),t.call(this,e)):i("missing",s,e)},function(){function s(){var e={mixins:Array.prototype.slice.call(arguments,0)},t=i.bind(e);return t.mixin=function(){return Array.prototype.push.apply(e.mixins,arguments),t},t}var r=Array.prototype.slice.call(arguments),i=function(){var i=Array.prototype.slice.call(arguments,0),s,o,u;return n={},Object.keys(e).forEach(function(t){n[t]=e[t]}),this.mixins&&this.mixins.forEach(function(e){e.beforeBuild&&e.beforeBuild(i)}),u=function(){return t.call(this,i)},!n.run&&!n.delay?s=u():(n.delay&&(o=u,u=function(){return n.delay(o)}),s=u(),n.run&&(s=n.run.apply(n,[s].concat(r)))),this.mixins&&this.mixins.forEach(function(e){e.afterBuild&&(s=e.afterBuild(s))}),s};return i.mixin=s,i}}return e.$let=function(e,t){return{kind:"let",name:e,expr:t}},e.$LET=function(e,t){return{kind:"letBind",name:e,expr:t}},e.$do=function(e){return{kind:"do",expr:e}},e.$DO=function(e){return{kind:"doBind",expr:e}},e.$return=function(e){return{kind:"$return",expr:e}},e.$RETURN=function(e){return{kind:"$RETURN",expr:e}},e.$yield=function(e){return{kind:"$yield",expr:e}},e.$YIELD=function(e){return{kind:"$YIELD",expr:e}},e.$for=function(e,t){var n=Array.prototype.slice.call(arguments,2);return{kind:"$for",name:e,items:t,cexpr:n}},e.$while=function(e){if(arguments.length<2)throw new Error('Incomplete `while`. Expected "$while(<condition>, <expr>)".');var t=Array.prototype.slice.call(arguments,1);return{kind:"$while",condition:e,cexpr:t}},e.$if=function(e,t,n){if(arguments.length<2)throw new Error('Incomplete conditional. Expected "$if(<expr>, $then(expr))" or "$if(<expr>, $then(<expr>), $else(<expr>)"');if(typeof e!="function")throw new Error("First argument must be a function that defines the condition of $if.");if(t.kind!=="$then")throw new Error('Unexpected "'+t.kind+'" in the place of "$then"');if(n&&n.kind!=="$else")throw new Error('Unexpected "'+n.kind+'" in the place of "$else"');return{kind:"$if",condition:e,thenExpr:t,elseExpr:n}},e.$then=function(){var e=Array.prototype.slice.call(arguments,0);if(e.length===0)throw new Error("$then should contain at least one expression.");return{kind:"$then",cexpr:e}},e.$else=function(){var e=Array.prototype.slice.call(arguments,0);if(e.length===0)throw new Error("$else should contain at least one expression.");return{kind:"$else",cexpr:e}},e.$=function(e){return{kind:"$",expr:e}},e}),define("scalejs.functional/completeBuilder",["./builder"],function(e){var t,n;return t=e({bind:function(e,t){return function(n){e(function(e){var r=t(e);return r(n)})}},$return:function(e){return function(t){t&&(typeof e=="function"&&(e=e()),t(e))}},delay:function(e){return e},run:function(e){return function(t){var n=e.call(this);n.call(this,t)}}}),n=t().mixin({beforeBuild:function(t){t.forEach(function(n,r){typeof n=="function"&&(t[r]=e.$DO(n))})}}),n}),define("scalejs.functional",["scalejs!core","./scalejs.functional/functional","./scalejs.functional/builder","./scalejs.functional/completeBuilder"],function(e,t,n,r){var i=e.object.merge;e.registerExtension({functional:i(t,{builder:n,builders:{complete:r}})})});